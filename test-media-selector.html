<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Media Selector</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles/main.css">
  <style>
    body {
      padding: 40px;
      font-family: sans-serif;
    }
    .test-btn {
      padding: 12px 24px;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      margin: 10px;
    }
    .test-btn:hover {
      background: #45a049;
    }
    .result {
      margin-top: 20px;
      padding: 20px;
      background: #f5f5f5;
      border-radius: 8px;
    }
    .result img {
      max-width: 300px;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <h1>Media Selector Test</h1>
  
  <div>
    <button class="test-btn" onclick="testImagePicker()">
      <i class="fas fa-image"></i> Test Image Picker
    </button>
    
    <button class="test-btn" onclick="testImagePickerUnsplash()">
      <i class="fab fa-unsplash"></i> Test Unsplash Tab
    </button>
    
    <button class="test-btn" onclick="testVideoPicker()">
      <i class="fas fa-video"></i> Test Video Picker
    </button>
  </div>
  
  <div class="result" id="result" style="display: none;">
    <h3>Result:</h3>
    <div id="resultContent"></div>
  </div>
  
  <div style="margin-top: 40px; padding: 20px; background: #fff3cd; border-radius: 8px;">
    <h3>Console Log:</h3>
    <div id="consoleLog" style="font-family: monospace; font-size: 12px;"></div>
  </div>

  <script src="js/media.js"></script>
  <script>
    // Capture console logs
    const consoleLog = document.getElementById('consoleLog');
    const originalLog = console.log;
    const originalError = console.error;
    const originalWarn = console.warn;
    
    function addLog(type, ...args) {
      const line = document.createElement('div');
      line.style.color = type === 'error' ? 'red' : type === 'warn' ? 'orange' : 'black';
      line.textContent = `[${type}] ${args.join(' ')}`;
      consoleLog.appendChild(line);
      consoleLog.scrollTop = consoleLog.scrollHeight;
    }
    
    console.log = function(...args) {
      addLog('log', ...args);
      originalLog.apply(console, args);
    };
    
    console.error = function(...args) {
      addLog('error', ...args);
      originalError.apply(console, args);
    };
    
    console.warn = function(...args) {
      addLog('warn', ...args);
      originalWarn.apply(console, args);
    };
    
    // Test functions
    async function testImagePicker() {
      console.log('Testing Image Picker...');
      try {
        const result = await window.MediaPicker.openImage();
        console.log('Result:', result);
        showResult(result);
      } catch (error) {
        console.error('Error:', error);
        alert('Error: ' + error.message);
      }
    }
    
    async function testImagePickerUnsplash() {
      console.log('Testing Image Picker with Unsplash tab...');
      try {
        const result = await window.MediaPicker.openImage({ defaultTab: 'unsplash' });
        console.log('Result:', result);
        showResult(result);
      } catch (error) {
        console.error('Error:', error);
        alert('Error: ' + error.message);
      }
    }
    
    async function testVideoPicker() {
      console.log('Testing Video Picker...');
      try {
        const result = await window.MediaPicker.openVideo();
        console.log('Result:', result);
        showResult(result);
      } catch (error) {
        console.error('Error:', error);
        alert('Error: ' + error.message);
      }
    }
    
    function showResult(result) {
      const resultDiv = document.getElementById('result');
      const contentDiv = document.getElementById('resultContent');
      
      resultDiv.style.display = 'block';
      
      let html = '<pre>' + JSON.stringify(result, null, 2) + '</pre>';
      
      if (result && result.url) {
        if (result.type === 'image') {
          html += `<img src="${result.url}" alt="Selected image">`;
        } else if (result.type === 'video') {
          html += `<video src="${result.url}" controls style="max-width: 400px;"></video>`;
        }
      }
      
      contentDiv.innerHTML = html;
    }
    
    // Check if MediaPicker is loaded
    console.log('MediaPicker available:', typeof window.MediaPicker !== 'undefined');
    console.log('MediaPicker.openImage:', typeof window.MediaPicker?.openImage);
  </script>
</body>
</html>
